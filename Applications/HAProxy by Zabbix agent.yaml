zabbix_export:
  version: '7.2'
  template_groups:
  - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
    name: Templates/Applications
  templates:
  - uuid: 812073bf8df143bcae2a84b32c3965e5
    template: HAProxy by Zabbix agent
    name: HAProxy by Zabbix agent
    description: |
      The template to monitor HAProxy by Zabbix that works without any external scripts.
      Most of the metrics are collected in one go, thanks to Zabbix bulk data collection.

      The template collects metrics by polling the HAProxy stats page with Zabbix agent.

      Note, that this template doesn't support authentication and redirects (limitations of 'web.page.get').

      Setup:

      1. Set up the HAProxy stats page:
      https://www.haproxy.com/blog/exploring-the-haproxy-stats-page/

      The example configuration of HAProxy:

      frontend stats
          bind *:8404
          stats enable
          stats uri /stats
          stats refresh 10s

      2. Set the hostname or IP address of the HAProxy stats host or container in the '{$HAPROXY.STATS.HOST}' macro. You can also change the status page port in the '{$HAPROXY.STATS.PORT}' macro, the status page scheme in the '{$HAPROXY.STATS.SCHEME}' macro and the status page path in the '{$HAPROXY.STATS.PATH}' macro if necessary.

      You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/393527-discussion-thread-for-official-zabbix-template-haproxy

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.2-1
    groups:
    - name: Templates/Applications
    tags:
    - tag: class
      value: software
    - tag: target
      value: haproxy
    macros:
    - macro: '{$HAPROXY.BACK_ERESP.MAX.WARN}'
      value: '10'
      description: Maximum of responses with error on BACKEND for trigger expression.
    - macro: '{$HAPROXY.BACK_QCUR.MAX.WARN}'
      value: '10'
      description: Maximum number of requests on BACKEND unassigned in queue for trigger
        expression.
    - macro: '{$HAPROXY.BACK_QTIME.MAX.WARN}'
      value: 10s
      description: Maximum of average time spent in queue on BACKEND for trigger expression.
    - macro: '{$HAPROXY.BACK_RTIME.MAX.WARN}'
      value: 10s
      description: Maximum of average BACKEND response time for trigger expression.
    - macro: '{$HAPROXY.FRONT_DREQ.MAX.WARN}'
      value: '10'
      description: The HAProxy maximum denied requests for trigger expression.
    - macro: '{$HAPROXY.FRONT_EREQ.MAX.WARN}'
      value: '10'
      description: The HAProxy maximum number of request errors for trigger expression.
    - macro: '{$HAPROXY.FRONT_SUTIL.MAX.WARN}'
      value: '80'
      description: Maximum of session usage percentage on frontend for trigger expression.
    - macro: '{$HAPROXY.RESPONSE_TIME.MAX.WARN}'
      value: 10s
      description: The HAProxy stats page maximum response time in seconds for trigger
        expression.
    - macro: '{$HAPROXY.SERVER_ERESP.MAX.WARN}'
      value: '10'
      description: Maximum of responses with error on server for trigger expression.
    - macro: '{$HAPROXY.SERVER_QCUR.MAX.WARN}'
      value: '10'
      description: Maximum number of requests on server unassigned in queue for trigger
        expression.
    - macro: '{$HAPROXY.SERVER_QTIME.MAX.WARN}'
      value: 10s
      description: Maximum of average time spent in queue on server for trigger expression.
    - macro: '{$HAPROXY.SERVER_RTIME.MAX.WARN}'
      value: 10s
      description: Maximum of average server response time for trigger expression.
    - macro: '{$HAPROXY.STATS.HOST}'
      value: localhost
      description: The hostname or IP address of the HAProxy stats host or container.
    - macro: '{$HAPROXY.STATS.PATH}'
      value: stats
      description: The path of HAProxy stats page.
    - macro: '{$HAPROXY.STATS.PORT}'
      value: '8404'
      description: The port of the HAProxy stats host or container.
    - macro: '{$HAPROXY.STATS.SCHEME}'
      value: http
      description: The scheme of HAProxy stats page(http/https).
