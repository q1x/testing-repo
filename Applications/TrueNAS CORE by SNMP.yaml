zabbix_export:
  version: '7.2'
  template_groups:
  - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
    name: Templates/Applications
  templates:
  - uuid: 28e31ef9402d4c1ba2fbc730a288d2d8
    template: TrueNAS CORE by SNMP
    name: TrueNAS CORE by SNMP
    description: |
      Template for monitoring TrueNAS CORE by SNMP.

      Setup:
      1. Import the template into Zabbix.
      2. Enable SNMP daemon at Services in TrueNAS CORE web interface: https://www.truenas.com/docs/core/uireference/services/snmpscreen/
      3. Link the template to the host.

      MIBs used:
      HOST-RESOURCES-MIB
      SNMPv2-MIB
      UCD-DISKIO-MIB
      UCD-SNMP-MIB
      FREENAS-MIB

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.2-1
    groups:
    - name: Templates/Applications
    tags:
    - tag: class
      value: hardware
    - tag: target
      value: truenas-core
    macros:
    - macro: '{$CPU.UTIL.CRIT}'
      value: '90'
      description: Threshold of CPU utilization for warning trigger in %.
    - macro: '{$DATASET.FREE.MIN.CRIT}'
      value: 5G
      description: This macro is used for trigger expression. It can be overridden
        on the host or linked on the template level.
    - macro: '{$DATASET.FREE.MIN.WARN}'
      value: 5G
      description: This macro is used for trigger expression. It can be overridden
        on the host or linked on the template level.
    - macro: '{$DATASET.NAME.MATCHES}'
      value: .+
      description: This macro is used in datasets discovery. Can be overridden on
        the host or linked template level
    - macro: '{$DATASET.NAME.NOT_MATCHES}'
      value: ^(boot|.+\.system(.+)?$)
      description: This macro is used in datasets discovery. Can be overridden on
        the host or linked template level
    - macro: '{$DATASET.PUSED.MAX.CRIT}'
      value: '90'
      description: Threshold of used dataset space for average severity trigger in
        %.
    - macro: '{$DATASET.PUSED.MAX.WARN}'
      value: '80'
      description: Threshold of used dataset space for warning trigger in %.
    - macro: '{$ICMP_LOSS_WARN}'
      value: '20'
      description: Threshold of ICMP packets loss for warning trigger in %.
    - macro: '{$ICMP_RESPONSE_TIME_WARN}'
      value: '0.15'
      description: Threshold of average ICMP response time for warning trigger in
        seconds.
    - macro: '{$IF.ERRORS.WARN}'
      value: '2'
      description: Threshold of error packets rate for warning trigger. Can be used
        with interface name as context.
    - macro: '{$IF.UTIL.MAX}'
      value: '90'
      description: Threshold of interface bandwidth utilization for warning trigger
        in %. Can be used with interface name as context.
    - macro: '{$IFCONTROL}'
      value: '1'
      description: Macro for operational state of the interface for link down trigger.
        Can be used with interface name as context.
    - macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
      value: '1.5'
      description: Load per CPU considered sustainable. Tune if needed.
    - macro: '{$MEMORY.AVAILABLE.MIN}'
      value: 20M
      description: Threshold of available memory for trigger in bytes.
    - macro: '{$MEMORY.UTIL.MAX}'
      value: '90'
      description: Threshold of memory utilization for trigger in %
    - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
      value: ^.*
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
      value: ^2$
      description: Ignore down(2) administrative status
    - macro: '{$NET.IF.IFALIAS.MATCHES}'
      value: .*
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFDESCR.MATCHES}'
      value: .*
      description: This macro used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
      value: ^.*$
      description: This macro used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
      value: ^6$
      description: Ignore notPresent(6)
    - macro: '{$NET.IF.IFTYPE.MATCHES}'
      value: .*
      description: This macro used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro used in filters of network interfaces discovery rule.
    - macro: '{$SNMP.TIMEOUT}'
      value: 5m
      description: The time interval for SNMP availability trigger.
    - macro: '{$SWAP.PFREE.MIN.WARN}'
      value: '50'
      description: Threshold of free swap space for warning trigger in %.
    - macro: '{$TEMPERATURE.MAX.CRIT}'
      value: '65'
      description: This macro is used for trigger expression. It can be overridden
        on the host or linked on the template level.
    - macro: '{$TEMPERATURE.MAX.WARN}'
      value: '50'
      description: This macro is used for trigger expression. It can be overridden
        on the host or linked on the template level.
    - macro: '{$VFS.DEV.DEVNAME.MATCHES}'
      value: .+
      description: This macro is used in block devices discovery. Can be overridden
        on the host or linked template level
    - macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
      value: 
        ^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|cd[0-9]*|pass[0-9]*|zram[0-9]*)
      description: This macro is used in block devices discovery. Can be overridden
        on the host or linked template level
    - macro: '{$ZPOOL.FREE.MIN.CRIT}'
      value: 5G
      description: This macro is used for trigger expression. It can be overridden
        on the host or linked on the template level.
    - macro: '{$ZPOOL.FREE.MIN.WARN}'
      value: 5G
      description: This macro is used for trigger expression. It can be overridden
        on the host or linked on the template level.
    - macro: '{$ZPOOL.PUSED.MAX.CRIT}'
      value: '90'
      description: Threshold of used pool space for average severity trigger in %.
    - macro: '{$ZPOOL.PUSED.MAX.WARN}'
      value: '80'
      description: Threshold of used pool space for warning trigger in %.
