zabbix_export:
  version: '7.2'
  template_groups:
  - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
    name: Templates/Applications
  templates:
  - uuid: 03e93dc9a8194a17958544a056d02316
    template: Microsoft 365 reports by HTTP
    name: Microsoft 365 reports by HTTP
    description: |
      This template is designed to monitor Microsoft 365 reports by HTTP. It works without any external scripts and uses script items.
      The template uses endpoints in the Microsoft Graph API to gather daily metrics from weekly reports.
      The template is meant to be used as a long-term trend monitoring tool.

      Setup:
        1. Register the app with Microsoft Entra ID.
        2. Configure Microsoft Graph application permissions on the app ID:
          `Reports.Read.All` - required for app usage and activity metrics
          `ServiceHealth.Read.All` - required for service discovery and service status metrics
        3. Request administrator consent.
        4. Configure the macros: `{$MS365.APP.ID}`, `{$MS365.PASSWORD}`, `{$MS365.TENANT.ID}`.

      You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.2-2
    groups:
    - name: Templates/Applications
    tags:
    - tag: class
      value: application
    - tag: target
      value: ms365
    macros:
    - macro: '{$MS365.API.TIMEOUT}'
      value: 15s
      description: API response timeout.
    - macro: '{$MS365.APP.ID}'
      description: Microsoft application ID.
    - macro: '{$MS365.HTTP.PROXY}'
      description: Sets the HTTP proxy value. If this macro is empty, then no proxy
        is used.
    - macro: '{$MS365.PASSWORD}'
      type: SECRET_TEXT
      description: The secret for the registered Microsoft application.
    - macro: '{$MS365.SERVICE.NAME.MATCHES}'
      value: .*
      description: This macro is used in the Microsoft cloud service discovery rule.
    - macro: '{$MS365.SERVICE.NAME.NOT.MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in the Microsoft cloud service discovery rule.
    - macro: '{$MS365.TENANT.ID}'
      description: Microsoft tenant ID.
