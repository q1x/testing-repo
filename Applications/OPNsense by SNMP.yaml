zabbix_export:
  version: '7.2'
  template_groups:
  - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
    name: Templates/Applications
  templates:
  - uuid: 0c94915edb4c41bf8c627dddb4f68f5a
    template: OPNsense by SNMP
    name: OPNsense by SNMP
    description: |
      Template for monitoring OPNsense by SNMP
      Setup:
        1. Enable bsnmpd daemon by creating new config file "/etc/rc.conf.d/bsnmpd" with the following content:
        bsnmpd_enable="YES"
        2. Uncomment the following lines in "/etc/snmpd.config" file to enable required SNMP modules:
        begemotSnmpdModulePath."hostres" = "/usr/lib/snmp_hostres.so"
        begemotSnmpdModulePath."pf"     = "/usr/lib/snmp_pf.so"
        3. Start bsnmpd daemon with the following command:
        /etc/rc.d/bsnmpd start
        4. Setup a firewall rule to get access from Zabbix proxy or Zabbix server by SNMP (https://docs.opnsense.org/manual/firewall.html).
        5. Link the template to a host.


      MIBs used:
      BEGEMOT-PF-MIB
      HOST-RESOURCES-MIB

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.2-1
    groups:
    - name: Templates/Applications
    tags:
    - tag: class
      value: software
    - tag: target
      value: opnsense
    macros:
    - macro: '{$IF.ERRORS.WARN}'
      value: '2'
      description: Threshold of error packets rate for warning trigger. Can be used
        with interface name as context.
    - macro: '{$IF.UTIL.MAX}'
      value: '90'
      description: Threshold of interface bandwidth utilization for warning trigger
        in %. Can be used with interface name as context.
    - macro: '{$IFCONTROL}'
      value: '1'
      description: Macro for operational state of the interface for link down trigger.
        Can be used with interface name as context.
    - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
      value: ^.*
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
      value: ^2$
      description: Ignore down(2) administrative status.
    - macro: '{$NET.IF.IFALIAS.MATCHES}'
      value: .*
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFDESCR.MATCHES}'
      value: .*
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
      value: (^pflog[0-9.]*$|^pfsync[0-9.]*$)
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
      value: ^.*$
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
      value: ^6$
      description: Ignore notPresent(6).
    - macro: '{$NET.IF.IFTYPE.MATCHES}'
      value: .*
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in filters of network interfaces discovery rule.
    - macro: '{$SNMP.TIMEOUT}'
      value: 5m
      description: The time interval for SNMP availability trigger.
    - macro: '{$SOURCE.TRACKING.TABLE.UTIL.MAX}'
      value: '90'
      description: Threshold of source tracking table utilization trigger in %.
    - macro: '{$STATE.TABLE.UTIL.MAX}'
      value: '90'
      description: Threshold of state table utilization trigger in %.
