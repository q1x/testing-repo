zabbix_export:
  version: '7.2'
  template_groups:
  - uuid: 36bff6c29af64692839d077febfc7079
    name: Templates/Network devices
  templates:
  - uuid: e56c9577c225476eb6d8f1c2f5dc90a5
    template: FortiGate by HTTP
    name: FortiGate by HTTP
    description: |
      The template for monitoring FortiGate Next Generation Firewall by HTTP.

      1. On the FortiGate GUI, select System > Admin Profiles > Create New.
      2. Enter a profile name (ex. zabbix_ro) and enable all the Read permissions. Please note the profile name, it will be used a bit later.
      3. Go to System > Administrators > Create New > REST API Admin.
      4. Enter the API-user's name and select the profile name you created in step 2.
      5. The trusted host can be specified to ensure that only Zabbix server can reach the FortiGate.
      6. Click OK and an API token will be generated. Make a note of the API token as it's only shown once and cannot be retrieved.
      7. Put the API token into {$FGATE.API.TOKEN} macro.
      8. Set your FortiGate GUI IP/FQDN as {$FGATE.API.FQDN} macro value.
      9. If FortiGate GUI uses HTTPS, put "https" value into {$FGATE.SCHEME} macro and "443" into {$FGATE.API.PORT} macro.
      10. If FortiGate GUI port differs from the standard one, specify it in {$FGATE.API.PORT} macro.

      You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback.

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.2-1
    groups:
    - name: Templates/Network devices
    tags:
    - tag: class
      value: network
    - tag: target
      value: fortigate
    - tag: target
      value: fortinet
    macros:
    - macro: '{$CPU.UTIL.CRIT}'
      value: '95'
      description: Threshold of CPU utilization for critical trigger in %.
    - macro: '{$CPU.UTIL.WARN}'
      value: '85'
      description: Threshold of CPU utilization for warning trigger in %.
    - macro: '{$DISK.FREE.CRIT}'
      value: '10'
      description: Threshold of disk free space for critical trigger in %.
    - macro: '{$DISK.FREE.WARN}'
      value: '20'
      description: Threshold of disk free space for warning trigger in %.
    - macro: '{$FGATE.API.FQDN}'
      description: FortiGate API FQDN/IP (ex. ngfw.example.com).
    - macro: '{$FGATE.API.PORT}'
      value: '80'
      description: The port of FortiGate API endpoint.
    - macro: '{$FGATE.API.TOKEN}'
      type: SECRET_TEXT
      description: FortiGate API token.
    - macro: '{$FGATE.DATA.TIMEOUT}'
      value: 15s
      description: Response timeout for an API.
    - macro: '{$FGATE.HTTP.PROXY}'
      description: HTTP proxy for API requests. You can specify it using the format
        [protocol://][username[:password]@]proxy.example.com[:port]. See the documentation
        at https://www.zabbix.com/documentation/7.2/manual/config/items/itemtypes/http
    - macro: '{$FGATE.SCHEME}'
      value: http
      description: Request scheme which may be http or https.
    - macro: '{$FIRMWARE.UPDATES.CONTROL}'
      value: '1'
      description: This macro is used in "New available firmware found" trigger.
    - macro: '{$FWP.FWACTION.MATCHES}'
      value: .*
      description: This macro is used in Firewall policies discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$FWP.FWACTION.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Firewall policies discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$FWP.FWNAME.MATCHES}'
      value: .*
      description: This macro is used in Firewall policies discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$FWP.FWNAME.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Firewall policies discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$FWP.FWTYPE.MATCHES}'
      value: .*
      description: This macro is used in Firewall policies discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$FWP.FWTYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Firewall policies discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$MEMORY.UTIL.CRIT}'
      value: '90'
      description: Threshold of memory utilization for critical trigger in %.
    - macro: '{$MEMORY.UTIL.WARN}'
      value: '80'
      description: Threshold of memory utilization for warning trigger in %.
    - macro: '{$NET.IF.CONTROL}'
      value: '1'
      description: Macro for operational state of the interface for "Link down" trigger.
        Can be used with interface name as context.
    - macro: '{$NET.IF.ERRORS.WARN}'
      value: '2'
      description: Threshold of error packets rate for warning trigger. Can be used
        with interface name as context.
    - macro: '{$NET.IF.IFALIAS.MATCHES}'
      value: .*
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFDESCR.MATCHES}'
      value: .*
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFNAME.MATCHES}'
      value: .*
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFSTATUS.MATCHES}'
      value: .*
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFSTATUS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFTYPE.MATCHES}'
      value: .*
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Network interfaces discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$NET.IF.UTIL.MAX}'
      value: '95'
      description: Threshold of interface bandwidth utilization for warning trigger
        in %. Can be used with interface name as context.
    - macro: '{$SDWAN.HEALTH.ID.MATCHES}'
      value: .*
      description: This macro is used in SD-WAN health-checks discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.HEALTH.ID.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in SD-WAN health-checks discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.HEALTH.IF.CONTROL}'
      value: '1'
      description: Macro for the interface state for "Link down" trigger. Can be used
        with interface name as context.
    - macro: '{$SDWAN.HEALTH.IF.LOSS.WARN}'
      value: '20'
      description: Threshold of packets loss for warning trigger in %. Can be used
        with interface name as context.
    - macro: '{$SDWAN.HEALTH.IFNAME.MATCHES}'
      value: .*
      description: This macro is used in SD-WAN health-checks discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.HEALTH.IFNAME.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in SD-WAN health-checks discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.HEALTH.NAME.MATCHES}'
      value: .*
      description: This macro is used in SD-WAN health-checks discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.HEALTH.NAME.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in SD-WAN health-checks discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.HEALTH.STATUS.MATCHES}'
      value: .*
      description: This macro is used in SD-WAN health-checks discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.HEALTH.STATUS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in SD-WAN health-checks discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.MEMBER.ID.MATCHES}'
      value: .*
      description: This macro is used in SD-WAN members discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.MEMBER.ID.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in SD-WAN members discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.MEMBER.IF.CONTROL}'
      value: '1'
      description: Macro for the interface state for "Link down" trigger. Can be used
        with interface name as context.
    - macro: '{$SDWAN.MEMBER.NAME.MATCHES}'
      value: .*
      description: This macro is used in SD-WAN members discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.MEMBER.NAME.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in SD-WAN members discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.MEMBER.STATUS.MATCHES}'
      value: .*
      description: This macro is used in SD-WAN members discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.MEMBER.STATUS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in SD-WAN members discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.MEMBER.ZONE.MATCHES}'
      value: .*
      description: This macro is used in SD-WAN members discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SDWAN.MEMBER.ZONE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in SD-WAN members discovery. Can be overridden
        on the host or linked template level.
    - macro: '{$SERVICE.EXPIRY.WARN}'
      value: '7'
      description: Number of days until the license expires.
    - macro: '{$SERVICE.KEY.MATCHES}'
      value: .*
      description: This macro is used in Service discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$SERVICE.KEY.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Service discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$SERVICE.LICENSE.CONTROL}'
      value: '1'
      description: This macro is used in Service discovery. Can be used with interface
        name as context.
    - macro: '{$SERVICE.STATUS.MATCHES}'
      value: .*
      description: This macro is used in Service discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$SERVICE.STATUS.NOT_MATCHES}'
      value: (no_support|no_license)
      description: This macro is used in Service discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$SERVICE.TYPE.MATCHES}'
      value: .*
      description: This macro is used in Service discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$SERVICE.TYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: This macro is used in Service discovery. Can be overridden on the
        host or linked template level.
