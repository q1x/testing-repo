zabbix_export:
  version: '7.2'
  template_groups:
  - uuid: 846977d1dfed4968bc5f8bdb363285bc
    name: Templates/Operating systems
  templates:
  - uuid: f9a59315c8944853bb91c0a9ec3056d7
    template: Windows by SNMP
    name: Windows by SNMP
    description: |
      This is an official Windows template. It requires an SNMP client.

      MIBs used:
      HOST-RESOURCES-MIB
      SNMPv2-MIB
      IF-MIB

      Known Issues:

        Description:
          64-bit I/O is not supported even though `IfxTable` is present.
          Currently, Windows gets its interface status from MIB-2. Since these 64-bit SNMP counters (`ifHCInOctets`, `ifHCOutOctets`, etc.) are defined as an extension to IF-MIB, Microsoft has not implemented it.
          https://social.technet.microsoft.com/Forums/windowsserver/en-US/07b62ff0-94f6-40ca-a99d-d129c1b33d70/windows-2008-r2-snmp-64bit-counters-support?forum=winservergen
        Version: Win2008, Win2012R2.

        Description: MIB is not supported
        Version: WindowsXP

        Description: EtherLike MIB is not supported
        Version: any

        Description:
          HOST-RESOURCES-MIB::hrStorageSize is limited to number 2147483647.
          Storage size is calculated using: `hrStorageSize` and `hrStorageAllocationUnits`.
          Allocation size of 512 bytes, sets the limit of monitored device to 1TB.
        Version: any

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.2-1
    groups:
    - name: Templates/Operating systems
    tags:
    - tag: class
      value: os
    - tag: target
      value: windows
    macros:
    - macro: '{$CPU.UTIL.CRIT}'
      value: '90'
      description: Critical threshold of CPU utilization expressed in %.
    - macro: '{$ICMP_LOSS_WARN}'
      value: '20'
      description: Warning threshold of ICMP packet loss in %.
    - macro: '{$ICMP_RESPONSE_TIME_WARN}'
      value: '0.15'
      description: Warning threshold of the average ICMP response time in seconds.
    - macro: '{$IF.ERRORS.WARN}'
      value: '2'
      description: Warning threshold of error packet rate. Can be used with interface
        name as context.
    - macro: '{$IF.UTIL.MAX}'
      value: '90'
      description: Used as a threshold in the interface utilization trigger.
    - macro: '{$IFCONTROL}'
      value: '1'
      description: Link status trigger will be fired only for interfaces where the
        context macro equals "1".
    - macro: '{$MEMORY.NAME.MATCHES}'
      value: .*
      description: Used in memory discovery. Can be overridden on the host or linked
        template level.
    - macro: '{$MEMORY.NAME.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in memory discovery. Can be overridden on the host or linked
        template level if you need to filter out results.
    - macro: '{$MEMORY.TYPE.MATCHES}'
      value: .*(\.2|hrStorageRam)$
      description: Used in memory discovery. Can be overridden on the host or linked
        template level.
    - macro: '{$MEMORY.TYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in memory discovery. Can be overridden on the host or linked
        template level if you need to filter out results.
    - macro: '{$MEMORY.UTIL.MAX}'
      value: '90'
      description: 'The warning threshold of the "Physical memory: Memory utilization"
        item.'
    - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
      value: ^.*$
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
      value: ^2$
      description: Ignore `down(2)` administrative status
    - macro: '{$NET.IF.IFALIAS.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFDESCR.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
      value: 
        Miniport|Virtual|Teredo|Kernel|Loopback|Bluetooth|HTTPS|6to4|QoS|Layer|isatap|ISATAP
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFNAME.MATCHES}'
      value: ^.*$
      description: Used for network interface discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
      value: (^Software Loopback 
        Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})
      description: Filters out `loopbacks`, `nulls`, docker `veth` links and `docker0`
        bridge by default.
    - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
      value: ^.*$
      description: Used for network interface discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
      value: ^6$
      description: Ignore `notPresent(6)`
    - macro: '{$NET.IF.IFTYPE.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in network interface discovery rule filters.
    - macro: '{$SNMP.TIMEOUT}'
      value: 5m
      description: Time interval for the SNMP availability trigger.
    - macro: '{$VFS.FS.FSNAME.MATCHES}'
      value: .+
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
      value: ^(/dev|/sys|/run|/proc|.+/shm$)
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSTYPE.MATCHES}'
      value: .*(\.4|\.9|hrStorageFixedDisk|hrStorageFlashMemory)$
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
      value: '90'
      description: The critical threshold of the filesystem utilization.
    - macro: '{$VFS.FS.PUSED.MAX.WARN}'
      value: '80'
      description: The warning threshold of the filesystem utilization.
