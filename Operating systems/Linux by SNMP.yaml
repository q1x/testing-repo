zabbix_export:
  version: '7.2'
  template_groups:
  - uuid: 846977d1dfed4968bc5f8bdb363285bc
    name: Templates/Operating systems
  templates:
  - uuid: 4d3a7adbb6964bd08f2b9d28e0da6496
    template: Linux by SNMP
    name: Linux by SNMP
    description: |
      This is an official Linux template. It requires an SNMP client.

      MIBs used:
      EtherLike-MIB
      HOST-RESOURCES-MIB
      SNMPv2-MIB
      UCD-DISKIO-MIB
      UCD-SNMP-MIB
      IF-MIB

      Notes on filesystem (FS) discovery:
        - The ext4/3/2 FS reserves space for privileged usage, typically set at 5% by default.
        - BTRFS allocates a default of 10% of the volume for its own needs.
        - To mitigate potential disasters, FS usage triggers are based on the maximum available space.
          - Utilization formula: 'pused = 100 * (used / used + available)'
        - The FS utilization chart, derived from graph prototypes, reflects FS reserved space as the difference between used and available space from the total volume.

      You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387225-discussion-thread-for-official-zabbix-template-for-linux

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.2-1
    groups:
    - name: Templates/Operating systems
    tags:
    - tag: class
      value: os
    - tag: target
      value: linux
    macros:
    - macro: '{$CPU.UTIL.CRIT}'
      value: '90'
      description: Critical threshold of CPU utilization expressed in %.
    - macro: '{$ICMP_LOSS_WARN}'
      value: '20'
      description: Warning threshold of ICMP packet loss in %.
    - macro: '{$ICMP_RESPONSE_TIME_WARN}'
      value: '0.15'
      description: Warning threshold of the average ICMP response time in seconds.
    - macro: '{$IF.ERRORS.WARN}'
      value: '2'
      description: Warning threshold of error packet rate. Can be used with interface
        name as context.
    - macro: '{$IF.UTIL.MAX}'
      value: '90'
      description: Used as a threshold in the interface utilization trigger.
    - macro: '{$IFCONTROL}'
      value: '1'
      description: Link status trigger will be fired only for interfaces where the
        context macro equals "1".
    - macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
      value: '1.5'
      description: Load per CPU considered sustainable. Tune if needed.
    - macro: '{$MEMORY.AVAILABLE.MIN}'
      value: 20M
      description: Used as a threshold in the available memory trigger.
    - macro: '{$MEMORY.UTIL.MAX}'
      value: '90'
      description: Used as a threshold in the memory utilization trigger.
    - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
      value: ^.*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
      value: ^2$
      description: Ignore `down(2)` administrative status
    - macro: '{$NET.IF.IFALIAS.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFDESCR.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFNAME.MATCHES}'
      value: ^.*$
      description: Used for network interface discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
      value: (^Software Loopback 
        Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})
      description: Filters out `loopbacks`, `nulls`, docker `veth` links and `docker0
        bridge` by default.
    - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
      value: ^.*$
      description: Used for network interface discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
      value: ^6$
      description: Ignore `notPresent(6)`
    - macro: '{$NET.IF.IFTYPE.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in network interface discovery rule filters.
    - macro: '{$SNMP.TIMEOUT}'
      value: 5m
      description: Time interval for the SNMP availability trigger.
    - macro: '{$SWAP.PFREE.MIN.WARN}'
      value: '50'
      description: The warning threshold of the minimum free swap.
    - macro: '{$VFS.DEV.DEVNAME.MATCHES}'
      value: .+
      description: Used in block device discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
      value: 
        ^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|zram[0-9]*)
      description: Used in block device discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSDEVICE.MATCHES}'
      value: .+
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSDEVICE.NOT_MATCHES}'
      value: .*(tmpfs|shm)$
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSNAME.MATCHES}'
      value: .+
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
      value: ^(/dev|/sys|/run|/proc|.+/shm$)
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.INODE.PFREE.MIN.CRIT}'
      value: '10'
      description: The critical threshold of the filesystem metadata utilization.
    - macro: '{$VFS.FS.INODE.PFREE.MIN.WARN}'
      value: '20'
      description: The warning threshold of the filesystem metadata utilization.
    - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
      value: '90'
      description: The critical threshold of the filesystem utilization.
    - macro: '{$VFS.FS.PUSED.MAX.WARN}'
      value: '80'
      description: The warning threshold of the filesystem utilization.
