zabbix_export:
  version: '7.2'
  template_groups:
  - uuid: 748ad4d098d447d492bb935c907f652f
    name: Templates/Databases
  templates:
  - uuid: 8ec72ebbe3204d7789429640abcac610
    template: TiDB by HTTP
    name: TiDB by HTTP
    description: |
      The template to monitor TiDB server of TiDB cluster by Zabbix that works without any external scripts.
      Most of the metrics are collected in one go, thanks to Zabbix bulk data collection.
      Don't forget to change the macros {$TIDB.URL}, {$TIDB.PORT}.

      Template `TiDB by HTTP` â€” collects metrics by HTTP agent from PD /metrics endpoint and from monitoring API.

      You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.2-1
    groups:
    - name: Templates/Databases
    tags:
    - tag: class
      value: database
    - tag: target
      value: tidb
    macros:
    - macro: '{$TIDB.DDL.WAITING.MAX.WARN}'
      value: '5'
      description: Maximum number of DDL tasks that are waiting
    - macro: '{$TIDB.GC_ACTIONS.ERRORS.MAX.WARN}'
      value: '1'
      description: Maximum number of GC-related operations failures
    - macro: '{$TIDB.HEAP.USAGE.MAX.WARN}'
      value: 10G
      description: Maximum heap memory used
    - macro: '{$TIDB.MONITOR_KEEP_ALIVE.MAX.WARN}'
      value: '10'
      description: Minimum number of keep alive operations
    - macro: '{$TIDB.OPEN.FDS.MAX.WARN}'
      value: '90'
      description: Maximum percentage of used file descriptors
    - macro: '{$TIDB.PORT}'
      value: '10080'
      description: The port of TiDB server metrics web endpoint
    - macro: '{$TIDB.REGION_ERROR.MAX.WARN}'
      value: '50'
      description: Maximum number of region related errors
    - macro: '{$TIDB.SCHEMA_LEASE_ERRORS.MAX.WARN}'
      value: '0'
      description: Maximum number of schema lease errors
    - macro: '{$TIDB.SCHEMA_LOAD_ERRORS.MAX.WARN}'
      value: '1'
      description: Maximum number of load schema errors
    - macro: '{$TIDB.TIME_JUMP_BACK.MAX.WARN}'
      value: '1'
      description: Maximum number of times that the operating system rewinds every
        second
    - macro: '{$TIDB.URL}'
      value: localhost
      description: TiDB server URL
