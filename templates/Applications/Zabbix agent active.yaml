zabbix_export:
  version: '7.0'
  template_groups:
  - uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
    name: Templates/Applications
  templates:
  - uuid: 650bec3f2f364a478b82317396949459
    template: Zabbix agent active
    name: Zabbix agent active
    description: |
      Use this template instead of 'Zabbix agent' for agents running in active mode only.

      Generated by official Zabbix template tool "Templator"
    vendor:
      name: Zabbix
      version: 7.0-0
    groups:
    - name: Templates/Applications
    items:
    - uuid: ca27c17d8ca34643a7db8b99d2cc3025
      name: 'Zabbix agent active: Host name of Zabbix agent running'
      type: ZABBIX_ACTIVE
      key: agent.hostname
      delay: 1h
      history: 7d
      value_type: CHAR
      trends: '0'
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 1d
      tags:
      - tag: component
        value: system
    - uuid: 0f86ec6cde2249f7946c678f9fd2665a
      name: 'Zabbix agent active: Zabbix agent ping'
      type: ZABBIX_ACTIVE
      key: agent.ping
      history: 7d
      description: The agent always returns 1 for this item. It could be used in combination
        with nodata() for availability check.
      valuemap:
        name: Zabbix agent ping status
      tags:
      - tag: component
        value: system
      triggers:
      - uuid: 6bbb74c522d44baea8c6ceb666423da2
        expression: nodata(/Zabbix agent active/agent.ping,{$AGENT.NODATA_TIMEOUT})=1
        name: 'Zabbix agent active: Zabbix agent is not available'
        event_name: 'Zabbix agent active: Zabbix agent is not available (or nodata
          for {$AGENT.NODATA_TIMEOUT})'
        priority: AVERAGE
        description: For active agents, nodata() with agent.ping is used with {$AGENT.NODATA_TIMEOUT}
          as time threshold.
        manual_close: YES
        tags:
        - tag: scope
          value: availability
    - uuid: 41fb0f76fa1d464f8ab67f744fc29e8b
      name: 'Zabbix agent active: Version of Zabbix agent running'
      type: ZABBIX_ACTIVE
      key: agent.version
      delay: 1h
      history: 7d
      value_type: CHAR
      trends: '0'
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 1d
      tags:
      - tag: component
        value: application
    - uuid: 0fd83c56dce244738607cd6585a6acb3
      name: 'Zabbix agent active: Active agent availability'
      type: INTERNAL
      key: zabbix[host,active_agent,available]
      history: 7d
      description: |
        Availability of active checks on the host. The value of this item corresponds to availability icons in the host list.
        Possible value:
        0 - unknown
        1 - available
        2 - not available
      valuemap:
        name: zabbix.host.active_agent.available
      tags:
      - tag: component
        value: health
      - tag: component
        value: network
      triggers:
      - uuid: e91c556b0ff64292b9b9b5709a5d74b3
        expression: min(/Zabbix agent active/zabbix[host,active_agent,available],{$AGENT.TIMEOUT})=2
        name: 'Zabbix agent active: Active checks are not available'
        opdata: 'Current state: {ITEM.LASTVALUE1}'
        priority: HIGH
        description: Active checks are considered unavailable. Agent is not sending
          heartbeat for prolonged time.
        tags:
        - tag: scope
          value: availability
    tags:
    - tag: class
      value: software
    - tag: target
      value: zabbix-agent
    macros:
    - macro: '{$AGENT.NODATA_TIMEOUT}'
      value: 30m
      description: No data timeout for active agents. Consider to keep it relatively
        high.
    - macro: '{$AGENT.TIMEOUT}'
      value: 5m
      description: Timeout after which agent is considered unavailable.
    dashboards:
    - uuid: 27dea14380314e67906525ad3d2a995a
      name: 'Zabbix agent active: Overview'
      pages:
      - name: Main
        widgets:
        - type: item
          name: Agent availability
          width: '18'
          height: '3'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Zabbix agent active
              key: agent.ping
          - type: INTEGER
            name: show.0
            value: '4'
          - type: INTEGER
            name: show.1
            value: '2'
        - type: item
          name: Version
          x: '18'
          width: '18'
          height: '3'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Zabbix agent active
              key: agent.version
          - type: INTEGER
            name: show.0
            value: '4'
          - type: INTEGER
            name: show.1
            value: '2'
        - type: graph
          x: '36'
          width: '36'
          height: '5'
          fields:
          - type: ITEM
            name: itemid.0
            value:
              host: Zabbix agent active
              key: agent.ping
          - type: STRING
            name: reference
            value: AAAAA
          - type: INTEGER
            name: source_type
            value: '1'
    valuemaps:
    - uuid: 9f93aabb08794395b1c62cf784fc58c3
      name: zabbix.host.active_agent.available
      mappings:
      - value: '0'
        newvalue: unknown
      - value: '1'
        newvalue: available
      - value: '2'
        newvalue: not available
    - uuid: 9bf3eef7e8d8402ca6f826b377ea2db6
      name: Zabbix agent ping status
      mappings:
      - value: '1'
        newvalue: Up
